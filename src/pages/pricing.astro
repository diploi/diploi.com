---
import Layout from '../layouts/Layout.astro'

import {
  SectionHeader,
  Section,
  Footer,
  ContactUsCard,
  GetStarted,
  Footer,
  Spacer,
  PricingType,
  PricingTable,
  Navigation,
  PageTag,
  Plans,
} from '../components'

const { pricing } = await fetch(
  'https://console.diploi.com/api/business/pricing',
).then((response) => response.json())
if (!pricing) {
  throw new Error(`Failed to load pricing (${pricing.status})`)
}
---

<Layout title="Diploi â€“ Pricing">
  <Navigation selected="pricing" />
  <main >
    <Section>
      <div class="pricing-cards">
        <div class="title-and-description">
          <PageTag title="Pricing" />
          <h2>Find the plan that fits your needs</h2>
        </div>
        <Plans pricing={pricing} />
      </div>

      <hr />

      <Section>
        <SectionHeader
          title="Single App Cluster Costs"
          highlightedText="Single App"
          description="A single App Cluster will run all the resources your application stack needs, such as webservers, databases, Redis, and more."
          descriptionSuffix="You will only be charged for the hours your cluster is running."
        />

        <PricingType pricing={pricing} />
        <PricingTable pricing={pricing} />
      </Section>
      <hr />
      <Section>
        <div class="callout">
          <GetStarted />
          <ContactUsCard />
        </div>
      </Section>
    </Section>
  </main>
  <Footer />
</Layout>

<style lang="scss">
  @use '../styles/mixins';

  .pricing-cards {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-huge);
    padding-top: var(--space-huge)
  }

  .callout {
    display: flex;
    flex-direction: column;
    gap: var(--space-xxl);
    @include mixins.respond-to('tablet') {
      flex-direction: row;
      gap: var(--space-l);
    }
  }
</style>
