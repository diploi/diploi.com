---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import { BrowserIcon, FileCodeIcon, LaptopIcon, SparkleIcon, ToolboxIcon } from '@phosphor-icons/react';
import Bullets from '../../../../components/Bullets';
import Help from '../../../../components/Help.astro';
import Link from '../../../../components/Link.astro';
import cursorLogo from '../../../../images/cursor-logo.webp';
import githubCopilotIcon from '../../../../images/github-copilot-icon.svg';
import githubLogo from '../../../../images/github-logo.svg';
import vscodeLogo from '../../../../images/vscode-logo.svg';
import webstormLogo from '../../../../images/webstorm-logo.svg';
import zedLogo from '../../../../images/zed-logo.svg';
import FeaturesComponentIcons from '../../_components/FeaturesComponentIcons.astro';
import FeaturesHr from '../../_components/FeaturesHr.astro';

const components = await getCollection('component');

const demoComponentIDs = ['react-vite', 'bun', 'postgres'];
const demoComponents = components
  .filter((component) => !component.data.hidden && demoComponentIDs.includes(component.id))
  .sort((a, b) => demoComponentIDs.indexOf(a.id) - demoComponentIDs.indexOf(b.id));
---

<ul class="features">
  <li>
    <LaptopIcon />
    <h3>Instant Dev Environment, One-Click</h3>
    <p>Nothing explains Diploi better than seeing it yourself. Click Launch to spin up a live demo.</p>
    <div class="options">
      <fieldset>
        <legend>Demo Stack</legend>
        <FeaturesComponentIcons components={demoComponents} />
      </fieldset>
      <p>or</p>
      <Link href="#stack-builder">Pick your own stack</Link>
    </div>
    <button>Launch Demo</button>
    <Help>Instant launch. No sign-up required.</Help>
  </li>
  <FeaturesHr vertical />
  <li>
    <SparkleIcon />
    <h3>Unmatched DX Experience, Zero-Install</h3>
    <ul class="logos">
      <li><Image width={40} height={40} src={cursorLogo} title="Cursor" alt="cursor logo" /></li>
      <li><Image width={40} height={40} src={vscodeLogo} title="VS Code" alt="vs code logo" /></li>
      <li><Image width={40} height={40} src={zedLogo} title="Zed" alt="zed logo" /></li>
      <li><Image width={40} height={40} src={githubLogo} title="GitHub" alt="github logo" /></li>
      <li><Image width={40} height={40} src={githubCopilotIcon} title="GitHub Copilot" alt="github copilot icon" /></li>
      <li><Image width={40} height={40} src={webstormLogo} title="WebStorm" alt="webstorm logo" /></li>
    </ul>
    <p>Enjoy a pro dev workflow with Git, CI/CD, and SSH. Connect your favorite editor, like Cursor or Zed â€” no setup required.</p>
    <Bullets total={3}>
      <Bullets.Item>
        <BrowserIcon weight="bold" /> Code in the browser
      </Bullets.Item>
      <Bullets.Item>
        <FileCodeIcon weight="bold" /> Infrastructure as code
      </Bullets.Item>
      <Bullets.Item>
        <ToolboxIcon weight="bold" />
        <a href="#stack-builder">Stack Builder</a> for scaffolding apps
      </Bullets.Item>
    </Bullets>
  </li>
</ul>

<style lang="scss">
  .features {
    display: grid;
    grid-template-columns: 1fr 1px 1fr;
    gap: 64px;

    @media (max-width: 860px) {
      grid-template-columns: 1fr;
      gap: 48px;

      :global(hr) {
        display: none;
      }
    }
  }

  li {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    min-width: 0;
  }

  li > svg {
    width: 32px;
    height: 32px;
  }

  .logos {
    display: flex;
    flex-wrap: wrap;
    gap: 16px;
  }

  .options {
    display: flex;
    align-items: center;
    gap: 16px;

    > fieldset {
      margin: 0;
      padding: 14px 18px;
      padding-top: 10px;
      background-image: linear-gradient(to bottom right, var(--color-accent-primary-20), transparent);
      border-color: var(--color-accent-primary);
      border-radius: var(--border-radius-button);
    }
  }
</style>
